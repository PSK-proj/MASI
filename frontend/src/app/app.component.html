<h1>Uniterm Editor</h1>

<app-formula-builder (treeChange)="onBuilderTree($event)"></app-formula-builder>
<div class="save-builder">
  <label for="builder-name">Nazwa sekwencji:</label>
  <input id="builder-name" #builderName placeholder="np. Zamiana A" />
  <button (click)="saveBuilder(builderName)">Zapisz sekwencję</button>
</div>

<hr />

<div class="builder">
  <fieldset class="controls">
    <legend>Przechowalnia</legend>
    <app-formula-list (select)="onSelectFormula($event)"></app-formula-list>
  </fieldset>

  <fieldset class="preview">
    <legend>Podgląd</legend>
    <ng-container *ngIf="preview">
      <app-formula-viewer [tree]="preview.tree"></app-formula-viewer>
      <div class="preview-actions">
        <button (click)="setAsTarget()">Ustaw jako bazę</button>
        <button (click)="setAsReplacement()">Ustaw jako zamiennik</button>
      </div>
    </ng-container>
    <ng-container *ngIf="!preview">
      <p>Wybierz sekwencję z lewej, aby ją podejrzeć</p>
    </ng-container>
  </fieldset>
</div>

<hr />

<div *ngIf="target">
  <h3>Target: {{ target.name }}</h3>
  <app-formula-viewer [tree]="target.tree" (nodeClick)="onNodePath($event)"></app-formula-viewer>
</div>
<div *ngIf="replacement">
  <h3>Replacement: {{ replacement.name }}</h3>
  <app-formula-viewer [tree]="replacement.tree"></app-formula-viewer>
</div>
<div *ngIf="target && replacement" class="replace-controls">
  <button (click)="doReplace()" [disabled]="!selectedPath">Zamień</button>
</div>

<hr />

<div *ngIf="resultTree">
  <h3>Wynik</h3>
  <app-formula-viewer [tree]="resultTree"></app-formula-viewer>
  <div class="save-result">
    <label for="result-name">Nazwa wyniku:</label>
    <input id="result-name" #resName placeholder="np. Wynik 1" />
    <button (click)="onSaveResult(resName)">Zapisz wynik</button>
  </div>
</div>